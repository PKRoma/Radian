var radian=angular.module("radian",[]);radian.factory("processAttrs",["radianEval",function(e){"use strict";return function(t,n){t.$$radianVars={},Object.keys(n).forEach(function(r){if(r=="id"||r=="class"||r.charAt(0)=="$"||r.search(/^ng[A-Z]/)!=-1)return;var i=e(t,n[r],!0,!0);t.$$radianVars[r]={fvs:i[1],expr:n[r]},t[r]=i[0];var s=t.$$radianVars[r];s.fvwatchers={},s.fvs.forEach(function(n){s.fvwatchers[n]=t.$watch(n,function(){t[r]=e(t,s.expr)},!0)}),n.$observe(r,function(n){s.expr=n;var i=e(t,n,!0);t[r]=i[0],s.fvs=i[1],Object.keys(s.fvwatchers).forEach(function(e){s.fvs.indexOf(e)==-1&&(s.fvwatchers[e](),delete s.fvwatchers[e])}),s.fvs.forEach(function(n){s.fvwatchers[n]||(s.fvwatchers[n]=t.$watch(n,function(){t[r]=e(t,s.expr)},!0))})})})}}]),radian.directive("plot",["processAttrs","$timeout","$rootScope","dumpScope","dft","radianLegend",function(e,t,n,r,i,s){"use strict";function o(t,r,i,s){e(t,i);var o=300,u=1.618,a=u*o,f=i.width,l=i.height,c=i.aspect,h=r.width(),p=r.height(),d=r.css("aspect")?parseFloat(r.css("aspect")):null;f&&l&&c||l&&f?(o=l,a=f,u=a/o):l&&c?(o=l,u=c,a=o*u):f&&c?(a=f,u=c,o=a/u):l?(o=l,h?(a=h,u=a/o):d?(u=d,a=o*u):a=o*u):f?(a=f,p?(o=p,u=a/o):d?(u=d,o=a/u):o=a/u):c?(u=c,h?(a=h,o=a/u):p?(o=p,a=o*u):a=o*u):p&&h?(o=p,a=h,u=a/o):p&&d?(o=p,u=d,a=o*u):h&&d?(a=h,u=d,o=a/u):p?(o=p,a=o*u):h?(a=h,o=a/u):d&&(u=d,o=a/u),t.width=a,t.height=o,t.svg=r.children()[1],n.strokesel=0,$(r).css("width",a).css("height",o),t.views=[],t.switchable=[],t.addPlot=function(e){t.hasOwnProperty("legendSwitches")&&t.switchable.push(e),e.enabled=!0},s(t.$new(),function(e){r.append(e)})}function u(e,n){function r(){e.views.forEach(function(t){d(t,e)})}function i(){e.$broadcast("setupExtra"),e.views=a.map(function(t,n){return p(e,t,n,a.length)}),f&&f(),r()}var o=d3.select(e.svg);e.uivisible&&(e.height-=parseInt($(n.children()[0]).css("height"))),o.attr("width",e.width).attr("height",e.height);var u=o.append("g").attr("width",e.width).attr("height",e.height),a=[u],f=null;if(e.hasOwnProperty("zoomX")){var l=e.zoomFraction||.2;l=Math.min(.95,Math.max(.05,l));var c=(e.height-6)*l,h=(e.height-6)*(1-l),v=o.append("g").attr("transform","translate(0,"+(h+6)+")").attr("width",e.width).attr("height",c);a.push(v),a[0].attr("height",h),f=function(){o.append("defs").append("clipPath").attr("id","xzoomclip").append("rect").attr("width",e.views[0].realwidth).attr("height",e.views[0].realheight),e.views[0].clip="xzoomclip";var t=d3.svg.brush().x(e.views[1].x);t.on("brush",function(){e.views[0].x.domain(t.empty()?e.views[1].x.domain():t.extent()),d(e.views[0],e)}),e.views[1].post=function(n){n.append("g").attr("class","x brush").call(t).selectAll("rect").attr("y",-6).attr("height",e.views[1].realheight+7)}}}t(function(){i(),s(o,e),e.$on("paintChange",r),e.$on("dataChange",i),e.$watch("strokesel",function(e,t){e!=undefined&&r()}),e.$watch("xidx",function(e,t){e!=undefined&&i()}),e.$watch("yidx",function(e,t){e!=undefined&&i()})},0)}function a(e,t,n,r,i,s,o,u,a,f){if(e.hasOwnProperty(t)||e.hasOwnProperty(n)||e.hasOwnProperty(r)){var l,c;if(e.hasOwnProperty(t)){var h=e[t].split(";");h.length==2&&(l=h[0],c=h[1])}e.hasOwnProperty(n)&&(l=e[n]),e.hasOwnProperty(r)&&(c=e[r]);if(l){var p=l.split(","),d=p.map(parseFloat),v=!1,m=null;p.length==2&&p[0]&&p[1]?!isNaN(d[0])&&!isNaN(d[1])&&(v=!0,m=[d[0],d[1]],e[i]=!0,e[s]=m):p.length==1||p.length==2&&!p[1]?isNaN(d[0])||(v=!0,m=[d[0],null]):p.length==2&&!p[0]&&(isNaN(d[1])||(v=!0,m=[null,d[1]])),v&&(e[o]=m)}if(c){var g=c.split(","),d=g.map(parseFloat),v=!1,m=null;g.length==2&&g[0]&&g[1]?!isNaN(d[0])&&!isNaN(d[1])&&(v=!0,m=[d[0],d[1]],e[u]=!0,e[a]=m):g.length==1||g.length==2&&!g[1]?isNaN(d[0])||(v=!0,m=[d[0],null]):g.length==2&&!g[0]&&(isNaN(d[1])||(v=!0,m=[null,d[1]])),v&&(e[f]=m)}}}function f(e,t,n){var r=e.axisXTransform||"linear";n?t.x=d3.time.scale().range([0,t.realwidth]).domain(e.xextent):r=="log"?t.x=d3.scale.log().range([0,t.realwidth]).domain(e.xextent).clamp(!0):t.x=d3.scale.linear().range([0,t.realwidth]).domain(e.xextent).clamp(!0)}function l(e,t,n){var r=e.axisXTransform||"linear";n?t.x2=d3.time.scale().range([0,t.realwidth]).domain(e.x2extent):r=="log"?t.x2=d3.scale.log().range([0,t.realwidth]).domain(e.x2extent).clamp(!0):t.x2=d3.scale.linear().range([0,t.realwidth]).domain(e.x2extent).clamp(!0)}function c(e,t){var n=e.axisYTransform||"linear";n=="log"?t.y=d3.scale.log().range([t.realheight,0]).domain(e.yextent).clamp(!0):t.y=d3.scale.linear().range([t.realheight,0]).domain(e.yextent).clamp(!0)}function h(e,t){var n=e.axisYTransform||"linear";n=="log"?t.y2=d3.scale.log().range([t.realheight,0]).domain(e.y2extent).clamp(!0):t.y2=d3.scale.linear().range([t.realheight,0]).domain(e.y2extent).clamp(!0)}function p(e,t,n,r){function o(e){return e[0]instanceof Array?d3.merge(e.map(function(e){return d3.extent(e)})):d3.extent(e)}function u(e,t,n,r){return e[0]instanceof Array?d3.merge(e.map(function(e){return d3.extent(e.filter(function(e,i){return t[i]>=n&&t[i]<=r}))})):d3.extent(e.filter(function(e,i){return t[i]>=n&&t[i]<=r}))}function L(t,n,r,s,o){var u=null;if(!t){i(e,function(e){t||e[n]&&e[n].metadata&&e[n].metadata.label&&(t=e[n].metadata.label,e[n].metadata.units&&(t+=" ("+e[n].metadata.units+")")),u=u||e[r]});if(!t&&e[s]){var a=e[s].split(",");t=a[u]}t||(t=o)}return t}var s={svg:t};a(e,"range","rangeX","rangeY","fixedXRange","xextent","xrange","fixedYRange","yextent","yrange"),a(e,"range2","rangeX2","rangeY2","fixedX2Range","x2extent","x2range","fixedY2Range","y2extent","y2range");var p=[],v=[],m=!1,g=[0,0],y=[0,0],b=[],w=[],E=!1;i(e,function(t){!e.fixedXRange&&t.enabled&&t.x&&(p=p.concat(o(t.x))),!e.fixedX2Range&&t.enabled&&t.x2&&(b=b.concat(o(t.x2))),!e.fixedYRange&&t.enabled&&t.y&&(e.fixedXRange?v=v.concat(u(t.y,t.x,e.xextent[0],e.xextent[1])):v=v.concat(o(t.y))),!e.fixedY2Range&&t.enabled&&t.y2&&(e.fixedXRange?w=w.concat(u(t.y2,t.x,e.xextent[0],e.xextent[1])):w=w.concat(o(t.y2))),t.x&&t.x.metadata&&t.x.metadata.format=="date"&&(m=!0),t.x2&&t.x2.metadata&&t.x2.metadata.format=="date"&&(E=!0),t.rangeXExtend&&(g[0]=Math.max(g[0],t.rangeXExtend[0]),g[1]=Math.max(g[1],t.rangeXExtend[1])),t.rangeYExtend&&(y[0]=Math.max(y[0],t.rangeYExtend[0]),y[1]=Math.max(y[1],t.rangeYExtend[1]))}),!e.fixedXRange&&p.length>0&&(e.xextent=d3.extent(p),e.xrange&&(e.xrange[0]!=null&&(e.xextent[0]=Math.min(e.xextent[0],e.xrange[0])),e.xrange[1]!=null&&(e.xextent[1]=Math.max(e.xextent[1],e.xrange[1]))),m||(e.xextent[0]-=g[0],e.xextent[1]+=g[1])),!e.fixedYRange&&v.length>0&&(e.yextent=d3.extent(v),e.yrange&&(e.yrange[0]!=null&&(e.yextent[0]=Math.min(e.yextent[0],e.yrange[0])),e.yrange[1]!=null&&(e.yextent[1]=Math.max(e.yextent[1],e.yrange[1]))),e.yextent[0]-=y[0],e.yextent[1]+=y[1]),!e.fixedX2Range&&b.length>0&&(e.x2extent=d3.extent(b),e.x2range&&(e.x2range[0]!=null&&(e.x2extent[0]=Math.min(e.x2extent[0],e.x2range[0])),e.x2range[1]!=null&&(e.x2extent[1]=Math.max(e.x2extent[1],e.x2range[1])))),!e.fixedY2Range&&w.length>0&&(e.y2extent=d3.extent(w),e.y2range&&(e.y2range[0]!=null&&(e.y2extent[0]=Math.min(e.y2extent[0],e.y2range[0])),e.y2range[1]!=null&&(e.y2extent[1]=Math.max(e.y2extent[1],e.y2range[1])))),s.xaxis=!e.axisX||e.axisX!="off",s.yaxis=!e.axisY||e.axisY!="off",s.x2axis=e.x2extent&&(!e.axisX2||e.axisX2!="off"),s.y2axis=e.y2extent&&(!e.axisY2||e.axisY2!="off");var S=(r==1||r==2&&n==1)&&(!e.axisXLabel||e.axisXLabel!="off"),x=!e.axisYLabel||e.axisYLabel!="off",T=(r==1||r==2&&n==1)&&(!e.axisX2Label||e.axisX2Label!="off"),N=!e.axisY2Label||e.axisY2Label!="off";s.margin={top:e.topMargin||2,right:e.rightMargin||10,bottom:e.bottomMargin||2,left:e.leftMargin||2};var C=e.axisXTransform||"linear",k=e.axisYTransform||"linear";return s.xaxis&&(s.margin.bottom+=20+(S?15:0)),s.yaxis&&(s.margin.left+=30+(x?22:0)),s.x2axis&&(s.margin.top+=20+(T?15:0)),s.y2axis&&(s.margin.right+=30+(N?22:0)),s.realwidth=s.svg.attr("width")-s.margin.left-s.margin.right,s.realheight=s.svg.attr("height")-s.margin.top-s.margin.bottom,s.outw=s.realwidth+s.margin.left+s.margin.right,s.outh=s.realheight+s.margin.top+s.margin.bottom,e.xextent&&f(e,s,m),e.yextent&&c(e,s,E),e.x2extent&&l(e,s),e.y2extent&&h(e,s),e.hasOwnProperty("axisXTransform")&&(e.watchXTransform||(e.watchXTransform=e.$watch("axisXTransform",function(t,n){if(t==undefined||t==C)return;C=t||"linear",e.views.forEach(function(t){f(e,t,m),e.x2&&l(e,t,E),d(t,e)})}))),e.hasOwnProperty("axisYTransform")&&(e.watchYTransform||(e.watchYTransform=e.$watch("axisYTransform",function(t,n){if(t==undefined||t==k)return;k=t||"linear",e.views.forEach(function(t){c(e,t),e.y2&&h(e,t),d(t,e)})}))),S&&(s.xlabel=L(e.axisXLabel,"x","xidx","selectX","X Axis")),x&&(s.ylabel=L(e.axisYLabel,"y","yidx","selectY","Y Axis")),T&&(s.x2label=L(e.axisX2Label,"x2","xidx","selectX2","X2 Axis")),N&&(s.y2label=L(e.axisY2Label,"y2","yidx","selectY2","Y2 Axis")),s}function d(e,t){$(e.svg[0]).empty();var n=e.svg.append("g").attr("width",e.outw).attr("height",e.outh),r=n.append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")");e.innersvg=r,e.clip&&r.attr("clip-path","url(#"+e.clip+")");if(e.xaxis&&e.x){var s=d3.svg.axis().scale(e.x).orient("bottom").ticks(n.attr("width")/100),o="%Y-%m-%d",u=!1;i(t,function(e){var t=e.x;t&&t.metadata&&t.metadata.format=="date"&&(t.metadata.dateFormat&&(o=t.metadata.dateFormat),u=!0),u=!1}),u&&s.tickFormat(d3.time.format(o)),n.append("g").attr("class","axis").attr("transform","translate("+e.margin.left+","+(+e.realheight+4)+")").call(s);if(e.xlabel)var a=0,f=35;n.append("g").attr("class","axis-label").attr("transform","translate("+(+e.margin.left+e.realwidth/2)+","+e.realheight+")").append("text").attr("x",a).attr("y",f).attr("text-anchor","middle").text(e.xlabel)}if(e.x2axis&&e.x2){var s=d3.svg.axis().scale(e.x2).orient("top").ticks(n.attr("width")/100),o="%Y-%m-%d",u=!1;i(t,function(e){var t=e.x2;t&&t.metadata&&t.metadata.format=="date"&&(t.metadata.dateFormat&&(o=t.metadata.dateFormat),u=!0),u=!1}),u&&s.tickFormat(d3.time.format(o)),n.append("g").attr("class","axis").attr("transform","translate("+e.margin.left+",4)").call(s);if(e.x2label)var a=0,f=35;n.append("g").attr("class","axis-label").attr("transform","translate("+(+e.margin.left+e.realwidth/2)+",0)").append("text").attr("x",a).attr("y",f).attr("text-anchor","middle").text(e.x2label)}if(e.yaxis&&e.y){var s=d3.svg.axis().scale(e.y).orient("left").ticks(n.attr("height")/36);n.append("g").attr("class","axis").attr("transform","translate("+(+e.margin.left-4)+",0)").call(s);if(e.ylabel){var a=12,f=e.realheight/2;n.append("g").attr("class","axis-label").append("text").attr("x",a).attr("y",f).attr("transform","rotate(-90,"+a+","+f+")").attr("text-anchor","middle").text(e.ylabel)}}if(e.y2axis&&e.y2){var s=d3.svg.axis().scale(e.y2).orient("right").ticks(n.attr("height")/36);n.append("g").attr("class","axis").attr("transform","translate("+(+e.realwidth+e.margin.left)+",0)").call(s);if(e.y2label){var a=e.realwidth+e.margin.left+40,f=e.realheight/2;n.append("g").attr("class","axis-label").append("text").attr("x",a).attr("y",f).attr("transform","rotate(-90,"+a+","+f+")").attr("text-anchor","middle").text(e.y2label)}}if(e.x&&e.y||e.x2&&e.y||e.x&&e.y2||e.x2&&e.y2)i(t,function(t){if(t.draw&&t.enabled){var n=!1,i=!1,s,o;t.x&&(n="x",s=e.x),t.x2&&(n="x2",s=e.x2),t.y&&(i="y",o=e.y),t.y2&&(i="y2",o=e.y2);if(n&&i){var u=r.append("g"),a=t[n][0]instanceof Array?t[n][t.xidx?t.xidx:0]:t[n],f=t[i][0]instanceof Array?t[i][t.yidx?t.yidx:0]:t[i];t.draw(u,a,s,f,o,t,e.realwidth,e.realheight,i=="y2"?2:1),t.$on("$destroy",function(){u.remove()})}}}),e.post&&e.post(e.innersvg)}return{restrict:"E",template:['<div class="radian">',"<radian-ui></radian-ui>","<svg></svg>","</div>"].join(""),replace:!0,transclude:!0,scope:!0,compile:function(e,t,n){return{pre:function(e,t,r){o(e,t,r,n)},post:u}}}}]),radian.factory("plotTypeLink",["processAttrs","$timeout",function(e,t){var n=["orientation","fill","fillOpacity","label","marker","markerSize","stroke","strokeOpacity","strokeWidth"];return function(r,i,s,o){function u(){var e=r.xchange||r.ychange;r.xchange=r.ychange=!1,e&&r.$emit("dataChange",r)}e(r,s),i.hide(),r.draw=o,r.$parent.addPlot(r),r.xchange=r.ychange=!1,r.$watch("x",function(e,n){if(e==undefined||e===n||r.xchange)return;r.xchange=!0,t(u)}),r.$watch("y",function(e,n){if(e==undefined||e===n||r.ychange)return;r.ychange=!0,t(u)}),n.forEach(function(e){r.hasOwnProperty(e)&&r.$watch(e,function(){r.$emit("paintChange",r)})})}}]),radian.directive("plotOptions",["processAttrs",function(e){"use strict";return{restrict:"E",template:"<div></div>",replace:!0,transclude:!0,scope:!0,compile:function(t,n,r){return{pre:function(t,n,i){e(t,i),r(t.$new(),function(e){n.append(e)})}}}}}]),radian.factory("radianEval",["plotLib","radianParse","genPalFn",function(plotLib,radianParse,genPalFn){var excnames=["Arguments","Array","Boolean","Date","Error","EvalError","Function","Global","JSON","Math","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError"],radianEval=function(scope,inexpr,returnfvs,skiperrors){if(typeof inexpr!="string"||inexpr.substr(0,2)!="[["&&inexpr.substr(-2)!="]]")return returnfvs?[inexpr,[]]:inexpr;var expr=inexpr.substr(2,inexpr.length-4);if(expr=="")return returnfvs?[0,[]]:0;var astorig=radianParse(expr);estraverse.traverse(astorig,{leave:function(e){delete e.start,delete e.end}});var ast=estraverse.replace(astorig,{enter:function(e){return e.type=="PaletteExpression"?{type:"MemberExpression",object:{type:"Identifier",name:"rad$$pal"},property:{type:"Identifier",name:genPalFn(e.palette)}}:e}}),metadatakey=null,dataset=null;estraverse.traverse(ast,{enter:function(e){if(e.type!="PluckExpression"&&e.type!="MemberExpression")return estraverse.VisitorOption.Skip;if(e.property.type=="Identifier"){metadatakey=e.property.name;var t=e.object;while(t.type!="Identifier")t=t.object;return dataset=t.name,estraverse.VisitorOption.Break}}});var exc={},excstack=[],fvs={};excnames.forEach(function(e){exc[e]=1}),Object.keys(plotLib).forEach(function(e){exc[e]=1}),estraverse.traverse(ast,{enter:function(e,t){switch(e.type){case"FunctionExpression":excstack.push(e.params.map(function(e){return e.name})),e.params.forEach(function(e){exc[e.name]?++exc[e.name]:exc[e.name]=1});break;case"Identifier":if(!exc[e.name]){var n=!0;t&&(t.type=="MemberExpression"||t.type=="PluckExpression")&&e==t.property&&!t.computed&&(n=!1),n&&(fvs[e.name]=1)}}},leave:function(e){e.type=="FunctionExpression"&&excstack.pop().forEach(function(e){--exc[e]==0&&delete exc[e]})}});var astrepl=estraverse.replace(ast,{leave:function(e){if(e.type=="BinaryExpression"){var t="";switch(e.operator){case"+":t="rad$$add";break;case"-":t="rad$$sub";break;case"*":t="rad$$mul";break;case"/":t="rad$$div";break;case"**":t="rad$$pow"}return t?{type:"CallExpression",callee:{type:"Identifier",name:t},arguments:[e.left,e.right]}:e}return e.type=="UnaryExpression"&&e.operator=="-"?{type:"CallExpression",callee:{type:"Identifier",name:"rad$$neg"},arguments:[e.argument]}:e}});astrepl=estraverse.replace(astrepl,{enter:function(e){return e.type=="CallExpression"&&e.callee.type=="PluckExpression"?{type:"CallExpression",callee:{type:"MemberExpression",object:e.callee.object,property:{type:"Identifier",name:"map"},computed:!1},arguments:[{type:"FunctionExpression",id:null,params:[{type:"Identifier",name:"$$x"}],body:{type:"BlockStatement",body:[{type:"ReturnStatement",argument:{type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:"$$x"},property:e.callee.property,computed:e.callee.property.type=="Literal"},arguments:e.arguments}}]}}]}:e},leave:function(e){if(e.type=="PluckExpression")return{type:"CallExpression",callee:{type:"MemberExpression",object:e.object,property:{type:"Identifier",name:"map"},computed:!1},arguments:[{type:"FunctionExpression",id:null,params:[{type:"Identifier",name:"$$x"}],body:{type:"BlockStatement",body:[{type:"ReturnStatement",argument:{type:"MemberExpression",object:{type:"Identifier",name:"$$x"},property:e.property,computed:e.property.type=="Literal"}}]}}]}}}),astrepl=estraverse.replace(astrepl,{enter:function(e,t){switch(e.type){case"FunctionExpression":excstack.push(e.params.map(function(e){return e.name})),e.params.forEach(function(e){exc[e.name]?++exc[e.name]:exc[e.name]=1});break;case"Identifier":if(!exc[e.name]&&fvs[e.name])return{type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:"scope"},property:{type:"Identifier",name:"$eval"},computed:!1},arguments:[{type:"Literal",value:e.name,raw:"'"+e.name+"'"}]}}return e},leave:function(e){return e.type=="FunctionExpression"&&excstack.pop().forEach(function(e){--exc[e]==0&&delete exc[e]}),e}});var access=escodegen.generate(astrepl),ret=[];try{with(plotLib)eval("ret = "+access)}catch(e){if(!skiperrors)throw Error("radianEval failed on '"+expr+"' -- "+e.message)}return ret&&dataset&&metadatakey&&scope[dataset]&&scope[dataset].metadata&&scope[dataset].metadata[metadatakey]&&(ret.metadata=scope[dataset].metadata[metadatakey]),returnfvs?[ret,Object.keys(fvs)]:ret};return radianEval}]),radian.factory("radianParse",function(){"use strict";function i(n,r){function c(e){return sn(e),i.start=o,i.end=u,i.type=a,i.value=f,i}e=String(n),t=e.length,Ut();var i={};return c.jumpTo=function(t,n){s=t;var r=e.charAt(t-1);l=n,Vt()},c}function g(t,n){var i=r(e,t);n+=" ("+i.line+":"+i.column+")";var o=new SyntaxError(n);throw o.pos=t,o.loc=i,o.raisedAt=s,o}function Lt(e){function o(e){if(e.length==1)return t+="return str === "+JSON.stringify(e[0])+";";t+="switch(str){";for(var n=0;n<e.length;++n)t+="case "+JSON.stringify(e[n])+":";t+="return true}return false;"}e=e.split(" ");var t="",n=[],r;for(var i=0;i<e.length;++i){r=!1;for(var s=0;s<n.length;++s)if(n[s][0].length==e[i].length){n[s].push(e[i]),r=!0;break}r||n.push([e[i]]),r=!1}if(n.length>3){n.sort(function(e,t){return t.length-e.length}),t+="switch(str.length){";for(var i=0;i<n.length;++i){var u=n[i];t+="case "+u[0].length+":",o(u)}t+="}"}else o(e);return new Function("str",t)}function qt(e){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e>=170&&Bt.test(String.fromCharCode(e))}function Rt(e){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e>=170&&jt.test(String.fromCharCode(e))}function Ut(){s=0,l=!0,Vt()}function zt(e,t){u=s,a=e,Vt(),f=t,l=e.beforeExpr}function Wt(){var t=e.indexOf("*/",s+=2);t===-1&&g(s-2,"Unterminated comment"),s=t+2}function Xt(){var n=e.charCodeAt(s+=2);while(s<t&&n!==10&&n!==13&&n!==8232&&n!==8329)++s,n=e.charCodeAt(s)}function Vt(){while(s<t){var n=e.charCodeAt(s);if(n===32)++s;else if(n===13){++s;var r=e.charCodeAt(s);r===10&&++s}else if(n===10)++s;else if(n<14&&n>8)++s;else if(n===47){var r=e.charCodeAt(s+1);if(r===42)Wt();else{if(r!==47)break;Xt()}}else if(n<14&&n>8||n===32||n===160)++s;else{if(!(n>=5760&&Dt.test(String.fromCharCode(n))))break;++s}}}function $t(){var t=e.charCodeAt(s+1);return t>=48&&t<=57?ln(!0):(++s,zt(ut))}function Jt(){var t=e.charCodeAt(s+1);return l?(++s,un()):t===61?on(ht,2):on(lt,1)}function Kt(){var t=e.charCodeAt(s+1);if(t===61)return on(ht,2);if(t===42){var n=e.charCodeAt(s+2);return t===61?on(ht,3):on(Nt,2)}return on(Tt,1)}function Qt(t){var n=e.charCodeAt(s+1);return n===t?on(t===124?mt:gt,2):n===61?on(ht,2):on(t===124?yt:wt,1)}function Gt(){var t=e.charCodeAt(s+1);return t===61?on(ht,2):on(bt,1)}function Yt(t){var n=e.charCodeAt(s+1);return n===t?on(dt,2):n===61?on(ht,2):on(pt,1)}function Zt(t){var n=e.charCodeAt(s+1),r=1;return n===t?(r=t===62&&e.charCodeAt(s+2)===62?3:2,e.charCodeAt(s+r)===61?on(ht,r+1):on(xt,r)):(n===61&&(r=e.charCodeAt(s+2)===61?3:2),on(St,r))}function en(t){var n=e.charCodeAt(s+1);return n===61?on(Et,e.charCodeAt(s+2)===61?3:2):on(t===61?ct:vt,1)}function tn(){var t=e.charCodeAt(s+1);if(t==80)return on(X,2);if(t==73)return on(V,2);g("Invalid palette token sequence")}function nn(){function t(e){return e>="0"&&e<="9"||e>="A"&&e<="F"||e>="a"&&e<="f"}++s;var n=0;for(var r=s;t(e.charAt(r))&&n<6;++r)++n;var i;n==6?(i=e.substr(s,6),s+=6):n==3?(i=e.substr(s,3),s+=3):g("Invalid colour constant");var o=S;return zt(o,i)}function rn(t,n){switch(t){case 46:return $t();case 35:return n?nn():(++s,zt(ft));case 40:return++s,zt(nt);case 41:return++s,zt(rt);case 59:return++s,zt(st);case 44:return++s,zt(it);case 91:return++s,zt(Y);case 93:return++s,zt(Z);case 123:return++s,zt(et);case 125:return++s,zt(tt);case 58:return++s,zt(ot);case 63:return++s,zt(at);case 48:var r=e.charCodeAt(s+1);if(r===120||r===88)return fn();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ln(!1);case 34:case 39:return hn(t);case 47:return Jt(t);case 37:case 42:return Kt();case 124:case 38:return Qt(t);case 94:return Gt();case 43:case 45:return Yt(t);case 60:case 62:return Zt(t);case 61:case 33:return en(t);case 126:return on(vt,1);case 64:return tn(t)}return!1}function sn(n,r){r&&--s,o=s;if(n)return un();if(s>=t)return zt(x);var i=e.charCodeAt(s);if(qt(i)||i===92)return mn();var u=rn(i,r);if(u===!1){var a=String.fromCharCode(i);if(a==="\\"||Bt.test(a))return mn();g(s,"Unexpected character '"+a+"'")}return u}function on(t,n){var r=e.slice(s,s+n);s+=n,zt(t,r)}function un(){var n="",r,i,o=s;for(;;){s>=t&&g(o,"Unterminated regular expression");var u=e.charAt(s);Ft.test(u)&&g(o,"Unterminated regular expression");if(!r){if(u==="[")i=!0;else if(u==="]"&&i)i=!1;else if(u==="/"&&!i)break;r=u==="\\"}else r=!1;++s}var n=e.slice(o,s);++s;var a=vn();return a&&!/^[gmsiy]*$/.test(a)&&g(o,"Invalid regexp flag"),zt(b,new RegExp(n,a))}function an(t,n){var r=s,i=0;for(var o=0,u=n==null?Infinity:n;o<u;++o){var a=e.charCodeAt(s),f;a>=97?f=a-97+10:a>=65?f=a-65+10:a>=48&&a<=57?f=a-48:f=Infinity;if(f>=t)break;++s,i=i*t+f}return s===r||n!=null&&s-r!==n?null:i}function fn(){s+=2;var t=an(16);return t==null&&g(o+2,"Expected hexadecimal number"),qt(e.charCodeAt(s))&&g(s,"Identifier directly after number"),zt(y,t)}function ln(t){var n=s,r=!1,i=e.charCodeAt(s)===48;!t&&an(10)===null&&g(n,"Invalid number"),e.charCodeAt(s)===46&&(++s,an(10),r=!0);var o=e.charCodeAt(s);if(o===69||o===101)o=e.charCodeAt(++s),(o===43||o===45)&&++s,an(10)===null&&g(n,"Invalid number"),r=!0;qt(e.charCodeAt(s))&&g(s,"Identifier directly after number");var u=e.slice(n,s),a;return r?a=parseFloat(u):!i||u.length===1?a=parseInt(u,10):/[89]/.test(u)||m?g(n,"Invalid number"):a=parseInt(u,8),zt(y,a)}function hn(n){s++,cn.length=0;for(;;){s>=t&&g(o,"Unterminated string constant");var r=e.charCodeAt(s);if(r===n)return++s,zt(w,String.fromCharCode.apply(null,cn));if(r===92){r=e.charCodeAt(++s);var i=/^[0-7]+/.exec(e.slice(s,s+3));i&&(i=i[0]);while(i&&parseInt(i,8)>255)i=i.slice(0,i.length-1);i==="0"&&(i=null),++s;if(i)m&&g(s-2,"Octal literal in strict mode"),cn.push(parseInt(i,8)),s+=i.length-1;else switch(r){case 110:cn.push(10);break;case 114:cn.push(13);break;case 120:cn.push(pn(2));break;case 117:cn.push(pn(4));break;case 85:cn.push(pn(8));break;case 116:cn.push(9);break;case 98:cn.push(8);break;case 118:cn.push(11);break;case 102:cn.push(12);break;case 48:cn.push(0);break;case 13:e.charCodeAt(s)===10&&++s;case 10:break;default:cn.push(r)}}else(r===13||r===10||r===8232||r===8329)&&g(o,"Unterminated string constant"),cn.push(r),++s}}function pn(e){var t=an(16,e);return t===null&&g(o,"Bad character escape sequence"),t}function vn(){dn=!1;var t,n=!0,r=s;for(;;){var i=e.charCodeAt(s);if(Rt(i))dn&&(t+=e.charAt(s)),++s;else{if(i!==92)break;dn||(t=e.slice(r,s)),dn=!0,e.charCodeAt(++s)!=117&&g(s,"Expecting Unicode escape sequence \\uXXXX"),++s;var o=pn(4),u=String.fromCharCode(o);u||g(s-1,"Invalid Unicode escape"),(n?!qt(o):!Rt(o))&&g(s-4,"Invalid Unicode escape"),t+=u}n=!1}return dn?t:e.slice(r,s)}function mn(){var e=vn(),t=E;return dn||(_t(e)?t=G[e]:m&&Ot(e)&&g(o,"The keyword '"+e+"' is reserved")),zt(t,e)}function gn(){c=o,h=u,sn()}function yn(e){m=e,s=h,Vt(),sn()}function bn(){this.type=null,this.start=o,this.end=null}function wn(){this.start=tokStartLoc,this.end=null}function En(){return new bn}function Sn(e){var t=new bn;return t.start=e.start,t}function xn(e,t){return e.type=t,e.end=h,e}function Tn(e){return e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&e.expression.value==="use strict"}function Nn(e){if(a===e)return gn(),!0}function Cn(){return a===x||a===tt||Ft.test(e.slice(h,o))}function kn(){!Nn(st)&&!Cn()&&An()}function Ln(e){a===e?gn():An()}function An(){g(o,"Unexpected token")}function On(e){e.type!=="Identifier"&&e.type!=="MemberExpression"&&g(e.start,"Assigning to rvalue"),m&&e.type==="Identifier"&&Mt(e.name)&&g(e.start,"Assigning to "+e.name+" in strict mode")}function Mn(){return c=h=s,d=m=null,v=[],sn(),qn()}function Pn(){a===lt&&sn(!0);var t=a,n=En();switch(t){case T:case k:gn();var r=t===T;Nn(st)||Cn()?n.label=null:a!==E?An():(n.label=nr(),kn());for(var i=0;i<v.length;++i){var s=v[i];if(n.label==null||s.name===n.label.name){if(!(s.kind==null||!r&&s.kind!=="loop"))break;if(n.label&&r)break}}return i===v.length&&g(n.start,"Unsyntactic "+t.keyword),xn(n,r?"BreakStatement":"ContinueStatement");case L:return gn(),kn(),xn(n,"DebuggerStatement");case O:return gn(),v.push(_n),n.body=Pn(),v.pop(),Ln(R),n.test=Hn(),kn(),xn(n,"DoWhileStatement");case D:gn(),v.push(_n),Ln(nt);if(a===st)return jn(n,null);if(a===q){var u=En();return gn(),In(u,!0),u.declarations.length===1&&Nn(Q)?Fn(n,u):jn(n,u)}var u=qn(!1,!0);if(Nn(Q))return On(u),Fn(n,u);return jn(n,u);case P:return gn(),Zn(n,!0);case H:return gn(),n.test=Hn(),n.consequent=Pn(),n.alternate=Nn(M)?Pn():null,xn(n,"IfStatement");case B:return d||g(o,"'return' outside of function"),gn(),Nn(st)||Cn()?n.argument=null:(n.argument=qn(),kn()),xn(n,"ReturnStatement");case j:gn(),n.discriminant=Hn(),n.cases=[],Ln(et),v.push(Dn);for(var l,p;a!=tt;)if(a===N||a===A){var y=a===N;l&&xn(l,"SwitchCase"),n.cases.push(l=En()),l.consequent=[],gn(),y?l.test=qn():(p&&g(c,"Multiple default clauses"),p=!0,l.test=null),Ln(ot)}else l||An(),l.consequent.push(Pn());return l&&xn(l,"SwitchCase"),gn(),v.pop(),xn(n,"SwitchStatement");case F:return gn(),Ft.test(e.slice(h,o))&&g(h,"Illegal newline after throw"),n.argument=qn(),kn(),xn(n,"ThrowStatement");case I:gn(),n.block=Bn(),n.handlers=[];while(a===C){var b=En();gn(),Ln(nt),b.param=nr(),m&&Mt(b.param.name)&&g(b.param.start,"Binding "+b.param.name+" in strict mode"),Ln(rt),b.guard=null,b.body=Bn(),n.handlers.push(xn(b,"CatchClause"))}return n.finalizer=Nn(_)?Bn():null,!n.handlers.length&&!n.finalizer&&g(n.start,"Missing catch or finally clause"),xn(n,"TryStatement");case q:return gn(),n=In(n),kn(),n;case R:return gn(),n.test=Hn(),v.push(_n),n.body=Pn(),v.pop(),xn(n,"WhileStatement");case U:return m&&g(o,"'with' in strict mode"),gn(),n.object=Hn(),n.body=Pn(),xn(n,"WithStatement");case et:return Bn();case st:return gn(),xn(n,"EmptyStatement");default:var w=f,S=qn();if(t===E&&S.type==="Identifier"&&Nn(ot)){for(var i=0;i<v.length;++i)v[i].name===w&&g(S.start,"Label '"+w+"' is already declared");var x=a.isLoop?"loop":a===j?"switch":null;return v.push({name:w,kind:x}),n.body=Pn(),v.pop(),n.label=S,xn(n,"LabeledStatement")}return n.expression=S,kn(),xn(n,"ExpressionStatement")}}function Hn(){Ln(nt);var e=qn();return Ln(rt),e}function Bn(e){var t=En(),n=!0,r=!1,i;t.body=[],Ln(et);while(!Nn(tt)){var s=Pn();t.body.push(s),n&&Tn(s)&&(i=r,yn(r=!0)),n=!1}return r&&!i&&yn(!1),xn(t,"BlockStatement")}function jn(e,t){return e.init=t,Ln(st),e.test=a===st?null:qn(),Ln(st),e.update=a===rt?null:qn(),Ln(rt),e.body=Pn(),v.pop(),xn(e,"ForStatement")}function Fn(e,t){return e.left=t,e.right=qn(),Ln(rt),e.body=Pn(),v.pop(),xn(e,"ForInStatement")}function In(e,t){e.declarations=[],e.kind="var";for(;;){var n=En();n.id=nr(),m&&Mt(n.id.name)&&g(n.id.start,"Binding "+n.id.name+" in strict mode"),n.init=Nn(ct)?qn(!0,t):null,e.declarations.push(xn(n,"VariableDeclarator"));if(!Nn(it))break}return xn(e,"VariableDeclaration")}function qn(e,t){var n=Rn(t);if(!e&&a===it){var r=Sn(n);r.expressions=[n];while(Nn(it))r.expressions.push(Rn(t));return xn(r,"SequenceExpression")}return n}function Rn(e){var t=Un(e);if(a.isAssign){var n=Sn(t);return n.operator=f,n.left=t,gn(),n.right=Rn(e),On(t),xn(n,"AssignmentExpression")}return t}function Un(e){var t=zn(e);if(Nn(at)){var n=Sn(t);return n.test=t,n.consequent=qn(!0),Ln(ot),n.alternate=qn(!0,e),xn(n,"ConditionalExpression")}return t}function zn(e){return Wn(Xn(e),-1,e)}function Wn(e,t,n){var r=a.binop;if(r!=null&&(!n||a!==Q)&&r>t){var i=Sn(e);i.left=e,i.operator=f,gn(),i.right=Wn(Xn(n),r,n);var i=xn(i,/&&|\|\|/.test(i.operator)?"LogicalExpression":"BinaryExpression");return Wn(i,t,n)}return e}function Xn(e){if(a.prefix){var t=En(),n=a.isUpdate;return t.operator=f,t.prefix=!0,gn(),t.argument=Xn(e),n?On(t.argument):m&&t.operator==="delete"&&t.argument.type==="Identifier"&&g(t.start,"Deleting local variable in strict mode"),xn(t,n?"UpdateExpression":"UnaryExpression")}var r=Vn();while(a.postfix&&!Cn()){var t=Sn(r);t.operator=f,t.prefix=!1,t.argument=r,On(r),gn(),r=xn(t,"UpdateExpression")}return r}function Vn(){return $n(Kn())}function $n(e,t){if(Nn(ut)){var n=Sn(e);return n.object=e,n.property=nr(!0),n.computed=!1,$n(xn(n,"MemberExpression"),t)}if(Nn(ft)){var n=Sn(e);return n.object=e,n.property=Jn(!0),n.computed=n.property.type=="Literal",$n(xn(n,"PluckExpression"),t)}if(Nn(Y)){var n=Sn(e);return n.object=e,n.property=qn(),n.computed=!0,Ln(Z),$n(xn(n,"MemberExpression"),t)}if(!t&&Nn(nt)){var n=Sn(e);return n.callee=e,n.arguments=tr(rt),$n(xn(n,"CallExpression"),t)}return e}function Jn(){switch(a){case E:return nr();case y:case w:case b:var t=En();return t.value=f,t.raw=e.slice(o,u),gn(),xn(t,"Literal");default:An()}}function Kn(){switch(a){case W:var t=En();return gn(),xn(t,"ThisExpression");case E:return nr();case y:case w:case b:var t=En();return t.value=f,t.raw=e.slice(o,u),gn(),xn(t,"Literal");case $:case J:case K:var t=En();return t.value=a.atomValue,t.raw=a.keyword,gn(),xn(t,"Literal");case nt:var n=tokStartLoc,r=o;gn();var i=qn();return i.start=r,i.end=u,Ln(rt),i;case Y:var t=En();return gn(),t.elements=tr(Z,!0),xn(t,"ArrayExpression");case et:return Gn();case P:var t=En();return gn(),Zn(t,!1);case X:var t=En();return gn(),er(t);case V:var t=En();return gn(),parseInterpolator(t);case z:return Qn();default:An()}}function Qn(){var e=En();return gn(),e.callee=$n(Kn(),!0),Nn(nt)?e.arguments=tr(rt):e.arguments=[],xn(e,"NewExpression")}function Gn(){var e=En(),t=!0,n=!1;e.properties=[],gn();while(!Nn(tt)){t?t=!1:Ln(it);var r={key:Yn()},i=!1,s;Nn(ot)?(r.value=qn(!0),s=r.kind="init"):r.key.type!=="Identifier"||r.key.name!=="get"&&r.key.name!=="set"?An():(i=n=!0,s=r.kind=r.key.name,r.key=Yn(),a!==nt&&An(),r.value=Zn(En(),!1));if(r.key.type==="Identifier"&&(m||n))for(var o=0;o<e.properties.length;++o){var u=e.properties[o];if(u.key.name===r.key.name){var f=s==u.kind||i&&u.kind==="init"||s==="init"&&(u.kind==="get"||u.kind==="set");f&&!m&&s==="init"&&u.kind==="init"&&(f=!1),f&&g(r.key.start,"Redefinition of property")}}e.properties.push(r)}return xn(e,"ObjectExpression")}function Yn(){return a===y||a===w?Kn():nr(!0)}function Zn(e,t){a===E?e.id=nr():t?An():e.id=null,e.params=[];var n=!0;Ln(nt);while(!Nn(rt))n?n=!1:Ln(it),e.params.push(nr());var r=d,i=v;d=!0,v=[],e.body=Bn(!0),d=r,v=i;if(m||e.body.body.length&&Tn(e.body.body[0]))for(var s=e.id?-1:0;s<e.params.length;++s){var o=s<0?e.id:e.params[s];(Ot(o.name)||Mt(o.name))&&g(o.start,"Defining '"+o.name+"' in strict mode");if(s>=0)for(var u=0;u<s;++u)o.name===e.params[u].name&&g(o.start,"Argument name clash in strict mode")}return xn(e,t?"FunctionDeclaration":"FunctionExpression")}function er(e){var t,n;Ln(et),a==E?(n=nr().name.toLowerCase(),"discrete".substr(0,n.length)==n?t="discrete":"absolute".substr(0,n.length)==n?t="absolute":"normalised".substr(0,n.length)==n?t="normalised":Nn(st)?t="colours":Nn(ot)?t="gradient":g("Invalid palette specification")):a==ft?(sn(!1,!0),n="#"+f,gn(),Nn(st)?t="colours":Nn(ot)?t="gradient":g("Invalid palette specification")):t="normalised";var r={type:t};switch(t){case"gradient":var i=n,s;a==E?s=nr().name.toLowerCase():a==ft?(sn(!1,!0),s="#"+f,gn()):g("Invalid palette specification"),Ln(tt),r={type:"normalised",values:[0,1],colours:[i,s]};break;case"colours":var o=[n],u=!1;while(!Nn(tt))u?u=!1:Ln(st),a==E?o.push(nr().name.toLowerCase()):a==ft?(sn(!1,!0),o.push("#"+f),gn()):g("Invalid palette specification");r={type:"discrete",values:null,colours:o};break;case"absolute":case"normalised":a==E&&(f=="banded"||f=="rgb"||f=="hsl"||f=="hcl"||f=="lab")&&(f=="banded"?(r.banded=!0,gn()):(r.interp=n,gn(),a==E&&f=="banded"&&(r.banded=!0,gn())));case"discrete":var u,l,o;u=!0,l=[],o=[];while(!Nn(tt)){u?u=!1:Nn(st);if(a==E)l.push(nr().name);else if(a==pt){var c=f=="-"?-1:1;gn(),a!=y&&g("Invalid palette specification"),l.push(c*f),gn()}else a==y?(l.push(f),gn()):g("Invalid palette specification"
);a==E?o.push(nr().name.toLowerCase()):a==ft?(sn(!1,!0),o.push("#"+f),gn()):g("Invalid palette specification")}r.values=l,r.colours=o}var e=En();return e.palette=r,xn(e,"PaletteExpression")}function tr(e,t){var n=[],r=!0;while(!Nn(e))r?r=!1:Ln(it),t&&a===it?n.push(null):n.push(qn(!0));return n}function nr(e){var t=En();return t.name=a===E?f:e&&a.keyword||An(),gn(),xn(t,"Identifier")}var e,t,n=function(n){return e=String(n),t=e.length,Ut(),Mn()},r=function(e,t){for(var n=1,r=0;;){It.lastIndex=r;var i=It.exec(e);if(!(i&&i.index<t))break;++n,r=i.index+i[0].length}return{line:n,column:t-r}},s,o,u,a,f,l,c,h,p,d,v,m,y={type:"num"},b={type:"regexp"},w={type:"string"},E={type:"name"},S={type:"colour"},x={type:"eof"},T={keyword:"break"},N={keyword:"case",beforeExpr:!0},C={keyword:"catch"},k={keyword:"continue"},L={keyword:"debugger"},A={keyword:"default"},O={keyword:"do",isLoop:!0},M={keyword:"else",beforeExpr:!0},_={keyword:"finally"},D={keyword:"for",isLoop:!0},P={keyword:"function"},H={keyword:"if"},B={keyword:"return",beforeExpr:!0},j={keyword:"switch"},F={keyword:"throw",beforeExpr:!0},I={keyword:"try"},q={keyword:"var"},R={keyword:"while",isLoop:!0},U={keyword:"with"},z={keyword:"new",beforeExpr:!0},W={keyword:"this"},X={keyword:"@P"},V={keyword:"@I"},$={keyword:"null",atomValue:null},J={keyword:"true",atomValue:!0},K={keyword:"false",atomValue:!1},Q={keyword:"in",binop:7,beforeExpr:!0},G={"break":T,"case":N,"catch":C,"continue":k,"debugger":L,"default":A,"do":O,"else":M,"finally":_,"for":D,"function":P,"if":H,"return":B,"switch":j,"throw":F,"try":I,"var":q,"while":R,"with":U,"null":$,"true":J,"false":K,"new":z,"in":Q,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":W,"@P":X,"@I":V,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},Y={type:"[",beforeExpr:!0},Z={type:"]"},et={type:"{",beforeExpr:!0},tt={type:"}"},nt={type:"(",beforeExpr:!0},rt={type:")"},it={type:",",beforeExpr:!0},st={type:";",beforeExpr:!0},ot={type:":",beforeExpr:!0},ut={type:"."},at={type:"?",beforeExpr:!0},ft={type:"#"},lt={binop:10,beforeExpr:!0},ct={isAssign:!0,beforeExpr:!0},ht={isAssign:!0,beforeExpr:!0},pt={binop:9,prefix:!0,beforeExpr:!0},dt={postfix:!0,prefix:!0,isUpdate:!0},vt={prefix:!0,beforeExpr:!0},mt={binop:1,beforeExpr:!0},gt={binop:2,beforeExpr:!0},yt={binop:3,beforeExpr:!0},bt={binop:4,beforeExpr:!0},wt={binop:5,beforeExpr:!0},Et={binop:6,beforeExpr:!0},St={binop:7,beforeExpr:!0},xt={binop:8,beforeExpr:!0},Tt={binop:10,beforeExpr:!0},Nt={binop:11,beforeExpr:!0},Ct={bracketL:Y,bracketR:Z,braceL:et,braceR:tt,parenL:nt,parenR:rt,comma:it,semi:st,colon:ot,dot:ut,question:at,slash:lt,eq:ct,name:E,eof:x,num:y,regexp:b,string:w,hash:ft};for(var kt in G)Ct[kt]=G[kt];var At=Lt("class enum extends super const export import"),Ot=Lt("implements interface let package private protected public static yield"),Mt=Lt("eval arguments"),_t=Lt("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Dt=/[\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]/,Pt="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Ht="ͱ-ʹ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",Bt=new RegExp("["+Pt+"]"),jt=new RegExp("["+Pt+Ht+"]"),Ft=/[\n\r\u2028\u2029]/,It=/\r\n|[\n\r\u2028\u2029]/g,cn=[],dn,_n={kind:"loop"},Dn={kind:"switch"};return n}),radian.directive("plotData",["$http",function(e){"use strict";function t(e,t,n,r){var i,s=/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/;switch(t){case"json":try{i=typeof e=="string"?JSON.parse(e):e}catch(o){throw Error("invalid JSON data in <plot-data>")}break;case"csv":try{i=$.csv.toArrays(e.replace(/^\s*\n/g,"").split("\n").map(function(e){return e.replace(/^\s+/,"")}).join("\n"),{separator:r});if(i.length>0){if(i[0].length!=n.length)throw Error("mismatch between COLS and CSV data in <plot-data>");var u={},a=[];for(var f=0;f<n.length;++f)u[n[f]]=[],a.push(i[0][f].match(s));for(var l=0;l<i.length;++l)for(var f=0;f<n.length;++f)a[f]?u[n[f]].push(parseFloat(i[l][f])):u[n[f]].push(i[l][f]);i=u}}catch(o){throw Error("invalid CSV data in <plot-data>")}}return i}function n(e,t,n){function r(e,i){e instanceof Array&&e.length>0?typeof e[0]=="string"&&i?e.forEach(function(t,r){e[r]=n(t)}):e.forEach(function(e){r(e,!1)}):typeof e=="object"&&Object.keys(e).forEach(function(n){r(e[n],n==t)})}r(e,!1)}function r(e,t,r){if(e[t]&&e[t].metadata)for(var i in e[t].metadata){var s=e[t].metadata[i];if(s.format=="date")if(!s.dateParseFormat)n(r,i,function(e){return new Date(e)});else{var o;s.dateParseFormat=="isodate"?o=d3.time.format.iso.parse:o=d3.time.format(s.dateParseFormat).parse,n(r,i,function(e){return o(e)})}}}function i(n,i,s){function h(e){var i=t(e,a,l,f);r(n,o,i);var s=n[o]?n[o].metadata:null;n[o]=i,s&&(n[o].metadata=s)}i.hide();if(!s.name)throw Error("<plot-data> must have NAME attribute");var o=s.name,u=s.src,a=s.format,f=s.separator===""?" ":s.separator||",",l=s.cols;l&&(l=l.split(",").map(function(e){return e.trim()}));if(!u){var c=["json","csv"];if(c.indexOf(a)==-1)throw Error('invalid FORMAT "'+a+'" in <plot-data>');if(a=="csv"&&!l)throw Error("CSV <plot-data> must have COLS")}if(!u){var p="";i.contents().each(function(e,t){t instanceof Text&&(p+=t.textContent)}),h(p)}else e.get(u).success(function(e,t,n,r){a=n("Content-Type")=="application/json"?"json":"csv";if(a=="csv"&&!l)throw Error("CSV <plot-data> must have COLS");h(e)}).error(function(){throw Error("failed to read data from "+u)})}return{restrict:"E",scope:!1,compile:function(e,t,n){return{post:i}}}}]),radian.directive("metadata",[function(){"use strict";return{restrict:"E",scope:!1,link:function(e,t,n){if(!t[0].parentNode||t[0].parentNode.tagName!="PLOT-DATA"||!$(t[0].parentNode).attr("name"))throw Error("<metadata> not properly nested inside <plot-data>");var r=$(t[0].parentNode).attr("name");if(!n.name)throw Error("<metadata> without NAME attribute");var i=n.name,s={};["dateFormat","dateParseFormat","errorFor","format","label","units"].forEach(function(e){n.hasOwnProperty(e)&&(s[e]=n[e])}),e[r]||(e[r]={metadata:{}}),e[r].metadata||(e[r].metadata={}),e[r].metadata[i]=s}}}]),radian.directive("lines",["plotTypeLink",function(e){"use strict";function t(e,t,n,r,i,s){function o(e){return e instanceof Array?function(t,n){return e[n]}:e}var u=s.strokeWidth||1,a=s.strokeOpacity||1,f=s.stroke||"#000";f instanceof Array&&s.strokesel!==undefined&&(f=s.strokesel?f[s.strokesel%f.length]:f[0]);if(f instanceof Function){var l=new Array(t.length);for(var c=0;c<t.length;++c)l[c]=c/t.length;f=f(l)}if(u instanceof Array||a instanceof Array||f instanceof Array){var p=200,d=Math.max(1,Math.floor(t.length/p)),v=d3.zip(t,r),m=[],g=[],y=[],b=[],w=0,E=d;while(w<t.length){m.push(v.slice(w,E+1));var S=Math.floor((w+E)/2);g.push(u instanceof Array?u[S]:u),y.push(a instanceof Array?a[S]:a),b.push(f instanceof Array?f[S]:f),w=E,E=w+d}e.selectAll("path").data(m).enter().append("path").attr("class","line").style("stroke-width",function(e,t){return g[t]}).style("stroke-opacity",function(e,t){return y[t]}).style("stroke",function(e,t){return b[t]}).style("fill","none").attr("d",d3.svg.line().x(function(e){return n(e[0])}).y(function(e){return i(e[1])}))}else{var h=d3.svg.line().x(function(e){return n(e[0])}).y(function(e){return i(e[1])});e.append("path").datum(d3.zip(t,r)).attr("class","line").attr("d",h).style("fill","none").style("stroke-width",u).style("stroke-opacity",a).style("stroke",f)}}return{restrict:"E",scope:!0,link:function(n,r,i){e(n,r,i,t)}}}]),radian.directive("points",["plotTypeLink",function(e){"use strict";function t(e,t,n,r,i,s){function d(e){return e instanceof Array?function(t,n){return e[n]}:e}var o=s.marker||"circle",u=s.markerSize||1,a=s.stroke||"#000",f=s.strokeWidth||1,l=s.strokeOpacity||1,c=s.fill||"none",h=s.fillOpacity||1,p=s.orientation||0,v=d3.svg.symbol().type(d(o)).size(d(u));e.selectAll("path").data(d3.zip(t,r)).enter().append("path").attr("transform",function(e){return"translate("+n(e[0])+","+i(e[1])+")"}).attr("d",v).style("fill",d(c)).style("fill-opacity",d(h)).style("stroke-width",d(f)).style("stroke-opacity",d(l)).style("stroke",d(a))}return{restrict:"E",scope:!0,link:function(n,r,i){e(n,r,i,t)}}}]),radian.directive("bars",["plotTypeLink",function(e){"use strict";function t(e,t,n,r,i,s,o,u){function v(e){return e instanceof Array?function(t,n){return e[n]}:e}var a=s.strokeWidth||1,f=s.strokeOpacity||1,l=s.stroke||"#000",c=s.fillOpacity||1,h=s.fill||"none",p=s.barWidth||1,d=s.barOffset||0;e.selectAll("rect").data(d3.zip(t,r)).enter().append("rect").attr("class","bar").attr("x",function(e,t){return e[0]instanceof Date?n(new Date(e[0].valueOf()-s.barWidths[t]*(p/2+d))):n(e[0]-s.barWidths[t]*(p/2+d))}).attr("y",function(e,t){return i(e[1])}).attr("width",function(e,t){return e[0]instanceof Date?n(new Date(e[0].valueOf()+s.barWidths[t]*p/2))-n(new Date(e[0].valueOf()-s.barWidths[t]*p/2)):n(e[0]+s.barWidths[t]*p/2)-n(e[0]-s.barWidths[t]*p/2)}).attr("height",function(e,t){return u-i(e[1])}).style("fill",v(h)).style("fill-opacity",v(c)).style("stroke-width",v(a)).style("stroke-opacity",v(f)).style("stroke",v(l))}return{restrict:"E",scope:!0,link:function(n,r,i){n.$on("setupExtra",function(){n.barWidths=n.x.map(function(e,t){return t==0?n.x[1]-e:t==n.x.length-1?e-n.x[n.x.length-2]:(n.x[t+1]-n.x[t-1])/2}),n.rangeXExtend=[n.barWidths[0]/2,n.barWidths[n.x.length-1]/2]}),e(n,r,i,t)}}}]),radian.directive("area",["plotTypeLink",function(e){"use strict";function t(e,t,n,r,i,s,o){var u=s.fillOpacity||1,a=s.fill||"#000",f=o==1?"ymin":"y2min",l,c=0;s.hasOwnProperty(f)&&(c=s[f]);if(c instanceof Array)l=c;else{l=new Array(t.length);for(var h=0;h<l.length;++h)l[h]=Number(c)}if(u instanceof Array||a instanceof Array)throw Error("<area> plots require singular paint attributes");var p=d3.svg.area().x(function(e){return n(e[0])}).y0(function(e){return i(e[1])}).y1(function(e){return i(e[2])});e.append("path").datum(d3.zip(t,l,r)).attr("class","area").attr("d",p).style("fill-opacity",u).style("fill",a)}return{restrict:"E",scope:!0,link:function(n,r,i){e(n,r,i,t)}}}]),radian.directive("palette",["discPalFn","contPalFn",function(e,t){"use strict";return{restrict:"E",scope:!1,link:function(n,r,i){r.hide();if(!i.name)throw Error("<palette> directive without NAME attribute");var s=i.name,o=i.type||"norm",u=i.interp||"hsl";u=u.toLowerCase();var a=i.hasOwnProperty("banded"),f="";r.contents().each(function(e,t){t instanceof Text&&(f+=t.textContent)}),f=f.replace(/\n/g,";");var l;switch(o){case"discrete":l=e(f);break;case"abs":l=t(!0,f,a,u);break;case"norm":l=t(!1,f,a,u);break;default:throw Error("invalid <palette> type: "+o)}n[s]=l}}}]),radian.factory("discPalFn",function(){return function(e){function t(e,t,n){if(n instanceof Array){var r={};n.forEach(function(e){r[e]=1});var i=Object.keys(r).sort();return n.map(function(n){return t[i.indexOf(n)%e]})}if(typeof n=="number")return t[(Math.round(n)-1)%e];throw Error("invalid operand to discrete palette function")}function n(e,t){return t instanceof Array?t.map(function(t){return e[t]}):e[t]}var r=e.split(";").map(function(e){return e.trim()}).filter(function(e){return e.length>0});if(r[0].indexOf(" ")!=-1){var i={};return r.forEach(function(e){var t=e.split(" "),n=t[0].trim(),r=t[1].trim();i[n]=r}),function(e){return n(i,e)}}var s=r.length,i="["+r.map(function(e){return'"'+e+'"'}).join(",")+"]";return function(e){return t(s,i,e)}}}),radian.factory("contPalFn",function(){return function(e,t,n,r){function i(e,t){if(t instanceof Array){var n=d3.extent(t),r=d3.scale.linear().domain(n);return t.map(function(t){return e(r(t))})}throw Error("normalised palettes must be applied to array arguments")}function s(e,t){return t instanceof Array?t.map(function(t){return e(t)}):e(t)}var o;if(n)o=function(e,t){return function(t){return e}};else switch(r){case"rgb":o=d3.interpolateRgb;break;case"hcl":o=d3.interpolateHcl;break;case"lab":o=d3.interpolateLab;break;default:o=d3.interpolateHsl}var u=t.split(";").map(function(e){return e.trim()}).filter(function(e){return e.length>0});if(!u.every(function(e){return e.indexOf(" ")!=-1}))throw Error("invalid format in <palette>");var a=[],f=[];u.forEach(function(e){var t=e.split(" ");a.push(Number(t[0].trim())),f.push(t[1].trim())});for(var l=1;l<a.length;++l)if(a[l]<a[l-1])throw Error("entries out of order in <palette>");var c=a[0],h=a[a.length-1];n&&(e?(a.push(Number.MAX_VALUE),f.push("black"),h=Number.MAX_VALUE):h!=1&&(a.push(1),f.push("black"),h=1));if(!!e||c==0&&h==1){var p=d3.scale.linear().clamp(!0).interpolate(o).domain(a).range(f);return e?function(e){return s(p,e)}:function(e){return i(p,e)}}throw Error("invalid segment limits for normalised palette")}}),radian.factory("genPalFn",["discPalFn","contPalFn","MD5","plotLib",function(e,t,n,r){"use strict";return function(i){var s;i.values?s=d3.zip(i.values,i.colours).map(function(e){return e.join(" ")}).join(";"):s=i.colours.join(";");var o=i.type.charAt(0)+n(JSON.stringify(s));if(!r.rad$$pal[o]){var u,a=i.interp||"hsl",f=i.banded;switch(i.type){case"discrete":u=e(s);break;case"absolute":u=t(!0,s,f,a);break;case"normalised":u=t(!1,s,f,a)}r.rad$$pal[o]=u}return o}}]),radian.factory("plotLib",function(){"use strict";function e(e){return function(t){return t instanceof Array?t.map(e):e(t)}}function t(e){return function(t,n){var r=t instanceof Array,i=n instanceof Array;if(!r&&!i)return e(t,n);var s=r?t.length:0,o=i?n.length:0,u=r&&i?Math.min(s,o):Math.max(s,o),a=new Array(u),f;r&&i?f=function(r){return e(t[r],n[r])}:r?f=function(r){return e(t[r],n)}:f=function(r){return e(t,n[r])};for(var l=0;l<u;++l)a[l]=f(l);return a}}function n(e){return function(t,n){var r={},i=[];t.forEach(function(e,t){r[n[t]]?r[n[t]].push(e):(i.push(n[t]),r[n[t]]=[e])});var s=[];return i.forEach(function(t){s.push(e(r[t]))}),s}}function r(e,t,n){return d3.range(e,t,(t-e)/(n-1))}function i(e,t,n){return d3.range(e,t,n)}function s(e){var t=d3.mean(e),n=d3.mean(e,function(e){return e*e});return Math.sqrt(n-t*t)}function o(e){var t=[],n={};return e.forEach(function(e){n[e]||(t.push(e),n[e]=1)}),t}function u(e){var t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-0.000005395239384953],n=1.000000000190015,r=e+5.5-(e+.5)*Math.log(e+5.5),i=n+sumArr(t.map(function(t,n){return t/(e+n+1)}));return-r+Math.log(2.5066282746310007*i/e)}function a(t,n,r){var i=1/(r*Math.sqrt(2*Math.PI)),s=2*r*r;return e(function(e){return i*Math.exp(-(e-n)*(e-n)/s)})(t)}function f(t,n,r){var i=1/(r*Math.sqrt(2*Math.PI)),s=2*r*r;return e(function(e){return e<=0?0:i/e*Math.exp(-(Math.log(e)-n)*(Math.log(e)-n)/s)})(t)}function l(t,n,r){var i=n*Math.log(r)+u(n);return e(function(e){return e<=0?0:Math.exp((n-1)*Math.log(e)-e/r-i)})(t)}function c(t,n,r){var i=n*Math.log(r)-u(n);return e(function(e){return e<=0?0:Math.exp(cval-r/e-(n+1)*Math.log(e))})(t)}function h(e,t){var n=d3.extent(e),r=(n[1]-n[0])/t,i=[],s=[];for(var o=0;o<t;++o)s.push(0),i.push(n[0]+r*(o+.5));for(var o=0;o<e.length;++o)++s[Math.min(t-1,Math.max(0,Math.floor((e[o]-n[0])/r)))];var u=[];for(var o=0;o<t;++o)u.push(s[o]/e.length);return{centres:i,counts:s,freqs:u}}function p(e){var t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(var r=0;r<e.length;++r)if(e[r]instanceof Array){var i=p(e[r]);t=Math.min(t,i[0]),n=Math.max(n,i[1])}else t=Math.min(t,e[r]),n=Math.max(n,e[r]);return[t,n]}function d(e,t,n){var r=n||"linear",i;switch(r){case"linear":i=d3.scale.linear();break;case"sqrt":i=d3.scale.sqrt();break;case"log":i=d3.scale.log();break;default:if(r.substr(0,4)!="pow:")throw Error("invalid interpolation type");i=d3.scale.pow().exponent(Number(r.substr(5)))}var s=e||[0,1];s=p(s);var o=t||[0,1];o=p(o);var u=i.domain(s).range(o);return function(e){return e.map(u)}}return{E:Math.E,LN10:Math.LN10,LN2:Math.LN2,LOG10E:Math.LOG10E,LOG2E:Math.LOG2E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,abs:e(Math.abs),acos:e(Math.acos),asin:e(Math.asin),atan:e(Math.atan),ceil:e(Math.ceil),cos:e(Math.cos),exp:e(Math.exp),floor:e(Math.floor),log:e(Math.log),round:e(Math.round),sin:e(Math.sin),sqrt:e(Math.sqrt),tan:e(Math.tan),atan2:Math.atan2,pow:Math.pow,min:d3.min,max:d3.max,extent:d3.extent,sum:d3.sum,mean:d3.mean,median:d3.median,quantile:d3.quantile,category10:e(d3.scale.category10()),category20:e(d3.scale.category20()),zip:d3.zip,seq:r,seqStep:i,sdev:s,unique:o,minBy:n(d3.min),maxBy:n(d3.max),sumBy:n(d3.sum),meanBy:n(d3.mean),sdevBy:n(s),normal:a,lognormal:f,gamma:l,invgamma:c,histogram:h,interpolate:d,rad$$neg:e(function(e){return-e}),rad$$add:t(function(e,t){return e+t}),rad$$sub:t(function(e,t){return e-t}),rad$$mul:t(function(e,t){return e*t}),rad$$div:t(function(e,t){return e/t}),rad$$pow:t(function(e,t){return Math.pow(e,t)}),rad$$pal:{}}}),radian.directive("radianUi",["$timeout",function(e){"use strict";return{restrict:"E",scope:!1,template:['<div class="radian-ui" ng-show="uivisible">','<span class="form-inline">','<span ng-show="xvs">',"<span>{{xlab}}</span>",'<select ng-model="xidx" class="var-select" ','ng-options="v[0] as v[1] for v in xvs">',"</select>","</span>",'<span ng-show="xvs && yvs">',"&nbsp;&nbsp;vs&nbsp;&nbsp;","</span>",'<span ng-show="yvs">',"<span>{{ylab}}</span>",'<select ng-model="yidx" class="var-select" ','ng-options="v[0] as v[1] for v in yvs">',"</select>","</span>",'<span ng-show="yvs && (swbut || swsel)">',"&nbsp;&nbsp;","</span>",'<span ng-show="swbut">',"<span>{{swbutlab}}</span>",'<button class="btn" data-toggle="button" ','ng-click="strokesel=1-strokesel">',"{{swbut}}","</button>","</span>",'<span ng-show="swsel">',"<label>{{swsellab}}&nbsp;</label>",'<select ng-model="strokesel" .span1 ','ng-options="o[0] as o[1] for o in swsel">',"</select>","</span>","</span>","</div>"].join(""),replace:!0,link:function(e,t,n){e.uivisible=!1;if(e.strokeSwitch!==undefined){e.uivisible=!0;var r=e.strokeSwitchLabel,i=e.strokeSwitch.split(";");i.length==1?(e.swbut=i[0],e.swbutlab=r):(e.swsel=i.map(function(e,t){return[t,e]}),e.swsellab=r)}if(e.selectX!==undefined){e.uivisible=!0;var s=e.selectX.split(",");s.length>1&&(e.xidx=0,e.xvs=s.map(function(e,t){return[t,e]}),e.xlab=e.selectXLabel,e.selectX==e.selectY&&e.$watch("xidx",function(t,n){t==e.yidx&&(e.yidx=n),e.yvs=[].concat(e.xvs),e.yvs.splice(t,1)}))}if(e.selectY!==undefined){e.uivisible=!0;var o=e.selectY.split(",");o.length>1&&(e.yidx=0,e.yvs=o.map(function(e,t){return[t,e]}),e.ylab=e.selectYLabel,e.selectX==e.selectY&&(e.yvs.splice(1),e.yidx=1))}}}}]),radian.factory("radianLegend",function(){return function(e,t){var n=t.switchable.length;if(n>1){var r=t.switchable,i=e.append("g").selectAll("g").data(r).enter().append("g"),s=i.append("circle").style("stroke-width",1).attr("r",5).attr("fill",function(e,t){return e.stroke||"#000"}).attr("stroke",function(e,t){return e.stroke||"#000"}),o=function(e,n){e.enabled=!e.enabled,d3.select(this).select("circle").attr("fill",e.enabled?e.stroke||"#000":"#f5f5f5"),t.$emit("paintChange")};i.on("click",o);var u=i.append("text").attr("text-anchor","start").attr("dy",".32em").attr("dx","8").text(function(e,t){return e.label||"data"+t}),a=[];u.each(function(e,t){a.push(d3.select(this).node().getComputedTextLength()+10)});var f=d3.max(a),l=15,c=f+l,h=n*f+(n-1)*l;i.attr("transform",function(e,n){return"translate("+(t.width-h+c*n)+",10)"})}}}),radian.factory("dft",function(){"use strict";return function(e,t){function n(e){t(e);for(var r=e.$$childHead;r;r=r.$$nextSibling)n(r)}n(e)}}),radian.factory("dftEsc",function(){"use strict";return function(e,t,n){function r(e,n){if(n&&!t(e))return;for(var i=e.$$childHead;i;i=i.$$nextSibling)r(i,!0)}r(e,n)}}),radian.factory("MD5",function(){return function(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n=e&2147483648,r=t&2147483648,i=e&1073741824,s=t&1073741824,o=(e&1073741823)+(t&1073741823);return i&s?o^2147483648^n^r:i|s?o&1073741824?o^3221225472^n^r:o^1073741824^n^r:o^n^r}function r(e,t,n){return e&t|~e&n}function i(e,t,n){return e&n|t&~n}function s(e,t,n){return e^t^n}function o(e,t,n){return t^(e|~n)}function u(e,i,s,o,u,a,f){return e=n(e,n(n(r(i,s,o),u),f)),n(t(e,a),i)}function a(e,r,s,o,u,a,f){return e=n(e,n(n(i(r,s,o),u),f)),n(t(e,a),r)}function f(e,r,i,o,u,a,f){return e=n(e,n(n(s(r,i,o),u),f)),n(t(e,a),r)}function l(e,r,i,s,u,a,f){return e=n(e,n(n(o(r,i,s),u),f)),n(t(e,a),r)}function c(e){var t,n=e.length,r=n+8,i=(r-r%64)/64,s=(i+1)*16,o=Array(s-1),u=0,a=0;while(a<n)t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|e.charCodeAt(a)<<u,a++;return t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|128<<u,o[s-2]=n<<3,o[s-1]=n>>>29,o}function h(e){var t="",n="",r,i;for(i=0;i<=3;i++)r=e>>>i*8&255,n="0"+r.toString(16),t+=n.substr(n.length-2,2);return t}function p(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t}var d=Array(),v,m,g,y,b,w,E,S,x,T=7,N=12,C=17,k=22,L=5,A=9,O=14,M=20,_=4,D=11,P=16,H=23,B=6,j=10,F=15,I=21;e=p(e),d=c(e),w=1732584193,E=4023233417,S=2562383102,x=271733878;for(v=0;v<d.length;v+=16)m=w,g=E,y=S,b=x,w=u(w,E,S,x,d[v+0],T,3614090360),x=u(x,w,E,S,d[v+1],N,3905402710),S=u(S,x,w,E,d[v+2],C,606105819),E=u(E,S,x,w,d[v+3],k,3250441966),w=u(w,E,S,x,d[v+4],T,4118548399),x=u(x,w,E,S,d[v+5],N,1200080426),S=u(S,x,w,E,d[v+6],C,2821735955),E=u(E,S,x,w,d[v+7],k,4249261313),w=u(w,E,S,x,d[v+8],T,1770035416),x=u(x,w,E,S,d[v+9],N,2336552879),S=u(S,x,w,E,d[v+10],C,4294925233),E=u(E,S,x,w,d[v+11],k,2304563134),w=u(w,E,S,x,d[v+12],T,1804603682),x=u(x,w,E,S,d[v+13],N,4254626195),S=u(S,x,w,E,d[v+14],C,2792965006),E=u(E,S,x,w,d[v+15],k,1236535329),w=a(w,E,S,x,d[v+1],L,4129170786),x=a(x,w,E,S,d[v+6],A,3225465664),S=a(S,x,w,E,d[v+11],O,643717713),E=a(E,S,x,w,d[v+0],M,3921069994),w=a(w,E,S,x,d[v+5],L,3593408605),x=a(x,w,E,S,d[v+10],A,38016083),S=a(S,x,w,E,d[v+15],O,3634488961),E=a(E,S,x,w,d[v+4],M,3889429448),w=a(w,E,S,x,d[v+9],L,568446438),x=a(x,w,E,S,d[v+14],A,3275163606),S=a(S,x,w,E,d[v+3],O,4107603335),E=a(E,S,x,w,d[v+8],M,1163531501),w=a(w,E,S,x,d[v+13],L,2850285829),x=a(x,w,E,S,d[v+2],A,4243563512),S=a(S,x,w,E,d[v+7],O,1735328473),E=a(E,S,x,w,d[v+12],M,2368359562),w=f(w,E,S,x,d[v+5],_,4294588738),x=f(x,w,E,S,d[v+8],D,2272392833),S=f(S,x,w,E,d[v+11],P,1839030562),E=f(E,S,x,w,d[v+14],H,4259657740),w=f(w,E,S,x,d[v+1],_,2763975236),x=f(x,w,E,S,d[v+4],D,1272893353),S=f(S,x,w,E,d[v+7],P,4139469664),E=f(E,S,x,w,d[v+10],H,3200236656),w=f(w,E,S,x,d[v+13],_,681279174),x=f(x,w,E,S,d[v+0],D,3936430074),S=f(S,x,w,E,d[v+3],P,3572445317),E=f(E,S,x,w,d[v+6],H,76029189),w=f(w,E,S,x,d[v+9],_,3654602809),x=f(x,w,E,S,d[v+12],D,3873151461),S=f(S,x,w,E,d[v+15],P,530742520),E=f(E,S,x,w,d[v+2],H,3299628645),w=l(w,E,S,x,d[v+0],B,4096336452),x=l(x,w,E,S,d[v+7],j,1126891415),S=l(S,x,w,E,d[v+14],F,2878612391),E=l(E,S,x,w,d[v+5],I,4237533241),w=l(w,E,S,x,d[v+12],B,1700485571),x=l(x,w,E,S,d[v+3],j,2399980690),S=l(S,x,w,E,d[v+10],F,4293915773),E=l(E,S,x,w,d[v+1],I,2240044497),w=l(w,E,S,x,d[v+8],B,1873313359),x=l(x,w,E,S,d[v+15],j,4264355552),S=l(S,x,w,E,d[v+6],F,2734768916),E=l(E,S,x,w,d[v+13],I,1309151649),w=l(w,E,S,x,d[v+4],B,4149444226),x=l(x,w,E,S,d[v+11],j,3174756917),S=l(S,x,w,E,d[v+2],F,718787259),E=l(E,S,x,w,d[v+9],I,3951481745),w=n(w,m),E=n(E,g),S=n(S,y),x=n(x,b);var q=h(w)+h(E)+h(S)+h(x);return q.toLowerCase()}}),radian.factory("dumpScope",function(){"use strict";var e=function(t,n){var r="";for(var i=0;i<n;++i)r=r.concat(" ");console.log(r+t.$id+": "+Object.keys(t).filter(function(e){return e.charAt(0)!="$"&&e!="this"}));for(var s=t.$$childHead;s;s=s.$$nextSibling)e(s,n+2)};return function(t){e(t,0)}});